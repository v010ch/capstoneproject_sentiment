# capstoneproject_tonality
 Выпускной проект - соревнование Kagle inclass https://www.kaggle.com/c/simplesentiment/overview
 
 По заданию дан !только! тестовый датасет с отзывами (русскоязычные, о телефонах). 
 2 класса: положительный и отрицательный.
 Нобходимо превзойти 0.85 по метрике accuracy.
 
 
 
 
  Оглавление:
 - Описание решения
 - Итог
 - Структура директорий проекта
 - Выполнение
 - Демонстрация работы алгоритмов



 ОПИСАНИЕ РЕШЕНИЯ
 
 Решение состоит из 2х этапов: сбор данных для обучения и обучение модели.
 
 Сбор данных.
 Данные собирал с сайта https://irecommend.ru/ (файл w6_tonality_AVV_collect_reviews.ipynb через selenium)
 Оценка 4 и 5 - положительный класс, иначе - отрицательный.
 
 Обучение модели.
 Т.к. не заданы условия по быстродействию, то можно использовать и тяжеловестные трансформеры, т.к. они
 дают сейчас наилучший результат. Однако не всегда есть возможность использовать тяжеловестные модели, т.о. 
 добавил легковестныю модель LogReg поверх признаков на tf-idf.
 
 В добавок есть демонстрация на flask (директория flask_app)




 ИТОГ
 
 0.97777 на паблике
  
 
 
 
 СТРУКТУРА ДИРЕКТОРИИ ПРОЕКТА
 
 
 
 
 ВЫПОЛНЕНИЕ
 
 В начале требуется установка необходимых библиотек
 pip install -r /path/to/requirements.txt
 так же необходимо установить Firefox и geckodriver https://github.com/mozilla/geckodriver/releases
 
 Затем последовательно выполняются:
 w6_tonality_AVV_collect_reviews.ipynb - выполняется сбор отзывов
 w4_tonality_create_light_model.ipynb  - обучение на собранном датасете легковестной LogReg
                                         поверх признакуов на tf-idf
 w6_tonality_avv_transformer.ipynb - (выполняется на colab) дообучение (transfer learning) модели
                                     'ru-blanchefort-rurewiew' на собранных отзывах на 1 эпохе
 
 
 
 ДЕМОНСТРАЦИЯ РАБОТЫ АЛГОРИТМА
 
 Штатный запуск:
 set FLASK_APP=app
 flask run
 http://127.0.0.1:5000/

 Отзывы на русском. Максимальная обрабатываемая длина - 96 слов без учета спецсимволов/цифр.
 Длинные отзывы позволяют лучше определить тональности.

 Первый запуск может потребовать время на загрузку.
 При переходе от первой страницы ко второй так же потребуется некоторое время.
 Для минимальной работы требуются штатные библиотеки + flask.

 Для получения лучшего результата требуется установленная библиотека nltk и загруженный стеммер RSLPStemmer.
 Для получения наилучшего результата требуется предустановленные библиотеки PyTorch и transformers.
 При наличии указанных библиотек и выборе соответствующих пунктов произойдет(однократная) загрузка модели.
 Объем загружаемой модели указан в таблице в приложении.
